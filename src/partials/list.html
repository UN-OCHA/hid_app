<div class="masthead">
  <h2 class="heading-contact-list">{{location}} <span translate>Contact List</span></h2>
</div>

<div class="main row page-list" ng-class="{'show-options': sidebarOptions}">
  <div class="active-contacts col-xs-12 col-sm-8 col-md-9 pull-right" cg-busy="contactsPromise">
    <form class="search-form">
      <div class="form-group">
        <label class="control-label element-invisible" for="text" translate>Search</label>
        <input class="form-control contact-search" type="search" name="text"
               placeholder="{{'Search by name, title, or organization'|translate}}" ng-model="query.text"/>
      </div>

      <div class="form-group">
        <input class="btn btn-primary btn-md element-invisible" ng-click="submitSearch()" type="submit"
               value="{{'Search'|translate}}"/>
      </div>
    </form>

    <ul class="list-group">
      <li class="profile-item list-group-item" ng-repeat="contact in contacts | orderBy: ['nameGiven', 'nameFamily']">
        <div class="row">
          <div class="contact-item contact-item--name col-xs-12 col-md-3" >
            <a href="#/contact/{{contact._id}}">{{contact.nameGiven}} {{contact.nameFamily}}</a>
            <div class="contact-item__markers" ng-if="contact.keyContact || contact._profile.verified">
              <div class="contact-item__key-contact" title="Key Contact" ng-if="contact.keyContact">*</div>
              <span class="contact-item__verified" title="Verified" ng-if="contact._profile.verified"><i class="fa fa-check-circle"></i></span>
            </div>
          </div>
          <div class="contact-item contact-item--jobtitle col-xs-7 col-md-3"><span title="{{contact.jobtitle}}">{{contact.jobtitle}}</span></div>
          <div class="contact-item contact-item--organization col-xs-5" ng-class="(contact.bundle.length) ? 'col-md-3' : 'col-md-6'"><span title="{{contact.organization[0].name}}">{{contact.organization[0].name}}</span></div>
          <div class="contact-item contact-item--bundle col-md-3" ng-hide="!contact.bundle.length"><span title="{{contact.bundle.join(', ')}}">{{contact.bundle.join(', ')}}</span></div>
        </div>
      </li>
    </ul>

    <div class="panel panel-danger" ng-if="contacts.length == 0">
      <div class="panel-heading"><em translate>No contacts found</em></div>
    </div>
  </div>


  <div class="sidebar-left">
    <div ng-show="!isRouteLoading">
      <div class="visible-xs">
        <div class="bottom-fixed-btn" role="presentation">
          <a href ng-click="sidebarOptions = !sidebarOptions"><div class="bottom-fixed-btn__arrow"></div>Contact List Filters</a>
        </div>
      </div>
    </div>

    <div class="actions-wrapper col-xs-12 col-sm-4 col-md-3">
      <form class="filter-form actions">

        <div class="form-group">
          <label class="control-label element-invisible" for="bundle" translate>Group</label>
          <select class="form-control" name="bundle" ng-model="query.bundle"
                  ng-options="bundle.value as bundle.value for bundle in bundles | orderBy:'value'">
            <option value="">Groups</option>
          </select>
        </div>

        <div class="form-group">
          <label class="control-label element-invisible" for="organization" translate>Organization</label>
          <ui-select ng-model="query.organization" theme="selectize" class="form-control"  name="organization" on-select="setOrganization($item, $model)">
            <ui-select-match placeholder="{{'Search for organization'|translate}}">{{$select.selected.name}}</ui-select-match>
            <ui-select-choices repeat="org in organizations | filter: $select.search | orderBy:'name'" refresh="refreshOrganization($select.search)" refresh-delay="500" reset-search-input="true">
              <div ng-bind-html="org.name | highlight: $select.search"></div>
            </ui-select-choices>
          </ui-select>
        </div>

        <div class="divider"></div>

        <div class="form-group">
          <label class="control-label" for="verified"><i class="fa fa-check-circle"></i> <span translate>Verified User</span> <input type="checkbox" name="verified" ng-model="query.verified" /></label>

        </div>

        <div class="form-group" ng-if="query.locationId">
          <label class="control-label" for="keyContact"><span class="contact-item__key-contact key-contact-filter-use">*</span> <span translate>Key Contact</span> <input type="checkbox" name="keyContact" ng-model="query.keyContact" /></label>
        </div>

        <div class="divider"></div>

        <div class="form-group">
          <input class="btn btn-primary btn-lg btn-block" type="submit" ng-click="submitSearch()" value="{{'Search'|translate}}"/>
          <input class="btn btn-warning btn-lg btn-block" type="button" ng-click="resetSearch()" value="{{'Reset Filters'|translate}}"/>
        </div>
      </form>
    </div>
  </div>
</div>

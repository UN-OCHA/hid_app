<div class="masthead element-invisible">
  <h2 translate>Humanitarian ID</h2>
</div>

<div ng-show='!isRouteLoading' class="main row page-dashboard" ng-class="{'show-options': sidebarOptions}">
  <div class="active-profiles main-content col-xs-12 col-sm-8 col-md-9 pull-right-hard" cg-busy="dashboardDataTracker">
    <div class="alert-wrapper">
      <div class="alert alert-warning" role="alert" ng-show="!globalProfileId.length"><span translate>Please create a</span> <a href="#/profile" translate>Global Profile</a> <span translate>before checking-in to a country/emergency.</span></div>
      <browser-alert></browser-alert>
    </div>
    <div class="active-profiles-wrapper" ng-show="userData.contacts.length">
      <h3><span translate>General List</span> :</h3>
      <ul class="active-profiles-container list-group">
        <li class="profile-item list-group-item" ng-repeat="profile in userData.contacts" ng-if="profile.type == 'global'">
          <h4>
            <a href="#/list/global">
              <span class="profile-item-name" translate>Global Contact List</span>
            </a>
          </h4>
          <div class="btn-group">
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" ng-click="share('Humanitarian ID','linkedin')" title="Share my profile on Linkedin"><i class="fa fa-linkedin"></i></a>
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" ng-click="share('Humanitarian ID','facebook')" title="Share my profile on Facebook"><i class="fa fa-facebook"></i></a>
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" href="#/profile/{{profile._id}}" title="{{'Edit my global profile' | translate}}"><i class="fa fa-pencil"></i></a>
          </div>
        </li>
      </ul>

      <h3><span translate>My checked-in lists</span> :</h3>
      <ul class="active-profiles-container list-group">
        <li class="profile-item list-group-item" ng-repeat="profile in userData.contacts | orderBy: 'location'" ng-if="profile.type == 'local'">

          <button ng-show="profile.confirmDelete" class="slide btn btn-warning" href ng-click="checkout(profile._id)" ng-if="profile.type == 'local'" translate>Checkout</button>

          <h4>
              <span class="profile-item-name">
                <a href="#/list/{{profile.locationId}}">{{profile.location}}</a>
                <span class="profile-item-disasters" ng-show="profile.disasters.length" ng-if="0">
                  <span class="profile-item-disaster-spacer">/</span>
                  <span class="profile-item-disaster" ng-repeat="disaster in profile.disasters | orderBy: 'name'">
                    <a href="#/list/{{profile.locationId}}?disasters.remote_id={{disaster.remote_id}}">{{disaster.name}}</a>
                  </span>
                </span>
              </span>
          </h4>
          <div class="btn-group">
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" ng-click="share(profile.location,'linkedin')" title="Share my check-in on Linkedin"><i class="fa fa-linkedin"></i></a>
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" ng-click="share(profile.location,'facebook')" title="Share my check-in on Facebook"><i class="fa fa-facebook"></i></a>
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-sm" href="#/profile/{{profile._id}}" title="{{'Edit my' | translate}} {{profile.location}} {{'profile' | translate}}"><i class="fa fa-pencil"></i></a>
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-checkout btn-sm" ng-click="profile.confirmDelete = !profile.confirmDelete" ng-if="profile.type == 'local'" title="{{'Check-out from' | translate}} {{profile.location}}"><i class="fa fa-times"></i></a>
          </div>
        </li>
        <li class="disaster-item" ng-if="profilesActive.length == 0">
          <em translate>No profiles found.</em>
        </li>
      </ul>

      <div class="alert alert-info" role="alert" ng-show="!localContacts.length && globalProfileId.length"><strong translate>Are you responding to a humanitarian situation?</strong> <a href="#/checkin" translate>Check into</a> <span translate>the relevant country to add your skills and contact details added to the appropriate contact list(s).</span></div>
      <div class="alert alert-info" role="alert" ng-show="localContacts.length"><strong translate>Are you still responding to the humanitarian situation(s) above?</strong> <span translate>Click the X next to "checkout" of any contact lists you are no longer responding to.</span></div>

      <h3><span translate>My Contacts lists</span> :</h3>
      <ul class="custom-contacts-container list-group">
        <li class="profile-item list-group-item" ng-repeat="(index, list) in customContacts">
          <h4>
            <a href="#/list/contacts?id={{list._id}}">
              <span class="profile-item-name" translate>{{list.name}}</span>
            </a>
          </h4>
          <div class="btn-group">
            <a ng-class="{'disabled' : isOffline()}" class="btn btn-primary" role="button" ng-if="userData.profile.userid != list.userid && list.isFollower" ng-click="unfollowContactList(list, index)">Unfollow List</a>
            <a ng-class="{'disabled' : isOffline()}" href="#/settings/list/{{list._id}}" class="btn btn-primary" role="button" ng-if="userData.profile.userid == list.userid ||Â list.isEditor">List Settings</a>
          </div>
        </li>
        <li class="profile-item list-group-item clearfix">
          <form name="contactInline" class="form-inline">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <p class="form-control-static"><strong>Make new list</strong></p>
              </div>
            </div>
            <div class="col-md-9 contact-inline-form">
              <div class="form-group">
                <label for="listName">List Name: </label>
                <input type="text" class="form-control" id="listName" ng-model="list.name" required>
              </div>
              <div class="form-group">
                <button type="submit" class="btn btn-primary" ng-disabled="contactInline.$invalid" ng-click="addCustomContactList(list)">Create List</button>
              </div>
            </div>
          </div>
          </form>
        </li>
      </ul>

      <div class="mobile-checkin visible-xs">
        <a class="btn btn-primary btn-lg btn-block" href="#/checkin">
          <span class="fa fa-angle-right"></span> <span translate>Check-in</span>
        </a>
      </div>
    </div>
    <div class="empty-profiles" ng-hide="userData.contacts.length">
      <p translate>Thank you for registering on Humanitarian ID. With your help, we will ensure that humanitarian contact lists are always up-to-date. As you will notice, you do not have access to any lists just yet.</p>
      <p translate>First, you will need to <em>create your Global profile</em>. In this profile, you will provide your usual details or information of where you are usually located.  After you have completed this step, you will see and have access to the Global contact list.</p>
      <p translate>Second, if you are in a country/emergency, you should <em>"Check-in" for that country/emergency</em>.  When you perform the check-in, you will see a copy of your profile that you can edit for that country/emergency.  Once checked-in, you will then have access to the contact list specific to the country/emergency.  And, other responders will be able to easily find you.</p>
      <p translate>When you leave a country/emergency, remember that <em>you need to check-out</em>. By doing so, you will remove your details from the contact list.</p>
      <p translate>Again, thanks for helping to make humanitarian contact lists accurate.</p>
      <p><em translate>The Humanitarian ID team</em></p>
    </div>
  </div>

  <div class="sidebar-left">
    <div ng-show="!isRouteLoading">
      <div class="visible-xs">
        <div class="bottom-fixed-btn" role="presentation">
          <a href ng-click="sidebarOptions = !sidebarOptions"><div class="bottom-fixed-btn__arrow"></div><span translate>Options</span></a>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-4 col-md-3 actions-wrapper">
      <div class="actions">
        <span ng-repeat="profile in userData.contacts" ng-if="profile.type == 'global'">
          <a ng-class="{'disabled' : isOffline()}" class="btn btn-default btn-lg btn-block" href="#/profile/{{profile._id}}">
            <span class="fa fa-angle-right"></span> <span translate>Edit Global Profile</span>
          </a>
        </span>
        <a ng-class="{'disabled' : isOffline()}" class="btn btn-primary btn-lg btn-block" href="#/checkin" ng-show="globalProfileId.length">
          <span class="fa fa-angle-right"></span> <span translate>Check-in</span>
        </a>
        <a ng-class="{'disabled' : isOffline()}" class="btn btn-primary btn-lg btn-block" href="#/createaccount" ng-show="userCanCreateAccount">
          <span class="fa fa-angle-right"></span> <span translate>Create a Responder</span>
        </a>
        <a class="btn btn-primary btn-lg btn-block" ng-show="!globalProfileId.length" href="#/profile/{{globalProfileId}}">
          <i class="entypo user"></i> <span translate>Global Profile</span>
        </a>
        <h3><span translate>View a Country</span> :</h3>
        <select class="form-control form-control-light" ng-options="operation as operation.name for operation in availOperations" ng-model="item" ng-change="toOperation()">
        </select>
      </div>
    </div>
  </div>

</div>
